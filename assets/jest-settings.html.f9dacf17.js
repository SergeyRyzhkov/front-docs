import{_ as i,r as o,o as l,c,a as s,b as t,w as e,d as n,e as u}from"./app.40083dda.js";const r={},d=s("h1",{id:"jest-nuxt-typescript",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#jest-nuxt-typescript","aria-hidden":"true"},"#"),n(" Jest Nuxt TypeScript")],-1),v={class:"table-of-contents"},k=n("\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 Jest"),b=n("\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 Babel"),g=n("\u0417\u0430\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435"),m=u(`<p>Back to your question. @nuxtjs/style-resources is not ESM module. File extension is .js, &quot;type&quot;: &quot;module&quot; is not declared in package.json, so Node will treat this module as CJS, but will choke on export default (line 6). We can change file extension or add &quot;type&quot;: &quot;module&quot;, but require does not exist in ESM (it is used in the very first line). This code is written is Javascript, but according to Node\u2019s specification this is not CJS, nor ESM module.</p><h2 id="\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0438-\u043D\u0430\u0441\u0442\u0440\u043E\u0438\u043A\u0430-jest" tabindex="-1"><a class="header-anchor" href="#\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0438-\u043D\u0430\u0441\u0442\u0440\u043E\u0438\u043A\u0430-jest" aria-hidden="true">#</a> \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 Jest</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> --dev jest ts-jest vue-jest @vue/test-utils @nuxt/test-utils @types/jest jest-serializer-vue jest-transform-stub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">@vue/test-utils vs @nuxt/test-utils</p><p>\u042D\u0442\u043E \u0434\u0432\u0430 \u0440\u0430\u0437\u043D\u044B\u0445 \u0438\u043D\u0441\u0442\u0440\u0443\u043C\u0435\u043D\u0442\u0430. \u0414\u043B\u044F \u0434\u043E\u0441\u0442\u0438\u0436\u0435\u043D\u0438\u044F \u043D\u0430\u0438\u043B\u0443\u0447\u0448\u0435\u0433\u043E \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0430 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u0438\u0445 \u043E\u0431\u0430.</p><p>\u0415\u0441\u043B\u0438 \u043C\u044B \u0433\u043E\u0432\u043E\u0440\u0438\u043C \u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F\u0445 Nuxt, <code>@nuxt/test-utils</code> \u0441\u043E\u0437\u0434\u0430\u0441\u0442 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 (\u0438\u043B\u0438 \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u0432\u0435\u0431-\u0441\u0430\u0439\u0442), \u0437\u0430\u043F\u0443\u0441\u0442\u0438\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u0438 \u043F\u0440\u0435\u0434\u043E\u0441\u0442\u0430\u0432\u0438\u0442 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0438 \u0442.\u0434.<br> \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440, <code>@nuxt/test-utils</code> \u043C\u043E\u0436\u0435\u0442 \u043F\u043E\u043C\u043E\u0447\u044C \u043F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C, \u0440\u0430\u0431\u043E\u0442\u0430\u044E\u0442 \u043B\u0438 \u043C\u0430\u0440\u0448\u0440\u0443\u0442\u044B, \u043C\u0438\u0434\u043B\u0432\u0430\u0440\u0435, \u043C\u043E\u0434\u0443\u043B\u0438 \u0438 \u0442.\u0434. \u0438 \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u044E\u0442\u0441\u044F \u043B\u0438 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B \u0434\u043E\u043B\u0436\u043D\u044B\u043C \u043E\u0431\u0440\u0430\u0437\u043E\u043C.<br> \u0422\u043E \u0435\u0441\u0442\u044C \u0430\u043A\u0446\u0435\u043D\u0442\u0438\u0440\u0443\u0435\u043C\u0441\u044F \u043D\u0430 \u043C\u0430\u0440\u0448\u0440\u0443\u0442\u0430\u0445, \u044D\u043A\u0437\u0435\u043C\u043F\u043B\u044F\u0440\u0435 Nuxt, \u043D\u043E \u043D\u0435 \u043D\u0430 \u043A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u0430\u0445 Vue.</p><p><code>@vue/test-utils</code> \u0434\u043B\u044F \u0442\u0435\u0441\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442\u043E\u0432 Vue (\u0438\u043B\u0438 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F Vue).<br> \u041F\u0443\u0431\u043B\u0438\u0447\u043D\u044B\u0439 API: mount(), smallMount(), render(), renderToString() \u0438 \u0442. \u0434. <code>@vue/test-utils</code> \u043D\u0435 \u0441\u043E\u0437\u0434\u0430\u0435\u0442 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F Nuxt \u0438 \u043D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u0437\u043D\u0430\u0435\u0442 \u043E\u0431 \u044D\u043A\u0437\u0435\u043C\u043F\u043B\u044F\u0440\u0435 Nuxt.</p></div><p>\u0412 \u043A\u043E\u0440\u043D\u0435 \u043F\u0440\u043E\u0435\u043A\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0444\u0430\u0439\u043B <strong><code>jest.config.ts</code></strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Config <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@jest/types&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ignorePaths <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;&lt;rootDir&gt;/.git&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;&lt;rootDir&gt;/.nuxt&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;&lt;rootDir&gt;/.vscode&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;&lt;rootDir&gt;/node_modules/&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> Config<span class="token punctuation">.</span>InitialOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  preset<span class="token operator">:</span> <span class="token string">&quot;@nuxt/test-utils&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// globalSetup: &quot;./jest.setup.ts&quot;,</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;^.+\\\\.ts$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ts-jest&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;^.+\\\\.js$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel-jest&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;.*\\\\.(vue)$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-jest&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  transformIgnorePatterns<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;/node_modules/&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  moduleNameMapper<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;^@/(.*)$&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;rootDir&gt;/src/$1&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  snapshotSerializers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&lt;rootDir&gt;/node_modules/jest-serializer-vue&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testURL<span class="token operator">:</span> <span class="token string">&quot;http://localhost/&quot;</span><span class="token punctuation">,</span>

  collectCoverage<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  collectCoverageFrom<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;&lt;rootDir&gt;/src/modules/**/*.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;&lt;rootDir&gt;/src/modules/**/*.ts&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  modulePathIgnorePatterns<span class="token operator">:</span> ignorePaths<span class="token punctuation">,</span>
  testPathIgnorePatterns<span class="token operator">:</span> ignorePaths<span class="token punctuation">,</span>
  coveragePathIgnorePatterns<span class="token operator">:</span> ignorePaths<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> config<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u0412 \u043A\u043E\u0440\u043D\u0435 \u043F\u0440\u043E\u0435\u043A\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0444\u0430\u0439\u043B <strong><code>jest.setup.js</code></strong></p><p>\u0412 \u0444\u0430\u0439\u043B\u0435 <code>tsconfig.json</code> \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C <code>&quot;@types/jest&quot;</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string-property property">&quot;types&quot;</span><span class="token operator">:</span>
   <span class="token punctuation">[</span>
    <span class="token string">&quot;@types/node&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@nuxt/types&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;@types/jest&quot;</span>
   <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u0412 \u0444\u0430\u0439\u043B\u0435 <code>package.json</code> \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nuxt&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nuxt build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nuxt start&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:script&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --ext .ts,vue --ignore-path .gitignore --fix src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:style&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stylelint \\&quot;**/*.{css,scss,sass,html,vue}\\&quot; --ignore-path .gitignore&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier --check .&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yarn lint:script &amp;&amp; yarn lint:style &amp;&amp; yarn lint:prettier&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier .  --write&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:unit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_OPTIONS=--experimental-vm-modules jest --no-cache --runInBand&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:unit:watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test:unit:coverage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --coverage&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yarn test:unit&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-babel" tabindex="-1"><a class="header-anchor" href="#\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-babel" aria-hidden="true">#</a> \u0423\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 Babel</h2><div class="custom-container tip"><p class="custom-container-title">\u0412\u0430\u0436\u043D\u043E!</p><p>\u0423\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0438\u043C\u0435\u043D\u043D\u043E <strong>babel-core@7.0.0-bridge.0</strong></p></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> --dev babel-core@7.0.0-bridge.0 @babel/preset-env babel-jest @babel/preset-typescript babel-plugin-dynamic-import-node babel-plugin-transform-decorators
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u0412 \u043A\u043E\u0440\u043D\u0435 \u043F\u0440\u043E\u0435\u043A\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0444\u0430\u0439\u043B <strong><code>babel.config.js</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="\u0437\u0430\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435" tabindex="-1"><a class="header-anchor" href="#\u0437\u0430\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435" aria-hidden="true">#</a> \u0417\u0430\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435</h2><ol><li>\u0412 \u0444\u0430\u0439\u043B\u0435 <code>.gitignore</code> \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>coverage
.nuxt-build-jest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,19),q={start:"2"},h=n('\u041E\u0447\u0435\u043D\u044C "\u0443\u0434\u043E\u0431\u043D\u043E\u0435" \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u0438\u0435 \u0434\u043B\u044F VS Code '),y={href:"https://github.com/jest-community/vscode-jest",target:"_blank",rel:"noopener noreferrer"},j=n("vscode-jest"),x=s("p",null,"\u0447\u0430\u0441\u0442\u044C 2 \u{1F603} \u0418\u0437\u0443\u0447\u0430\u044E \u043A\u0438\u0448\u043A\u0438...",-1),_=s("p",null,`\u0412\u043E\u0442 \u0435\u0433\u043E \u043F\u0440\u0435\u0441\u0435\u0442 https://github.com/nuxt/test-utils/blob/main/jest-preset.js \u0421\u0442\u0430\u0432\u0438\u0442 \u043C\u043D\u0435 \u043E\u043A\u0440\u0443\u0436\u0435\u043D\u0438\u0435 \u0432 'node', \u0430 js|ts "\u043F\u0440\u043E\u0433\u043E\u043D\u044F\u0435\u0442" \u0447\u0435\u0440\u0435\u0437 babel-jest \u0411\u0435\u0439\u0431\u0435\u043B\u044C \u043D\u0430 \u043A\u0440\u0430\u0439, \u043F\u043E\u043A\u0430 \u0432 \u0442\u043E\u043F\u043A\u0443 \u043F\u0440\u0435\u0441\u0435\u0442 \u041D\u0443\u0436\u0435\u043D \u0442\u0430\u043A\u043E\u0439 \u0442\u0440\u0430\u043D\u0441\u0444\u043E\u0440\u043C transform: { "^.+\\.ts$": "ts-jest", ".*\\.(vue)$": "vue-jest", },`,-1),f=s("p",null,'\u0421\u043C\u043E\u0442\u0440\u044E \u0440\u0443\u043A\u043E\u0436\u043E\u043F\u043D\u044B\u0439 \u043F\u0430\u043A\u0435\u0442 style-resources \u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043D\u0438\u0435 js, \u0432 package.json "type": "module" \u041D\u0415\u0422. \u0414\u043B\u044F Node \u0437\u043D\u0430\u0447\u0438\u0442 \u044D\u0442\u043E CJS , \u043D\u043E \u0442\u0430\u043C \u0435\u0441\u0442\u044C export ...',-1);function w(N,S){const a=o("RouterLink"),p=o("ExternalLinkIcon");return l(),c("div",null,[d,s("nav",v,[s("ul",null,[s("li",null,[t(a,{to:"#\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-\u0438-\u043D\u0430\u0441\u0442\u0440\u043E\u0438\u043A\u0430-jest"},{default:e(()=>[k]),_:1})]),s("li",null,[t(a,{to:"#\u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430-babel"},{default:e(()=>[b]),_:1})]),s("li",null,[t(a,{to:"#\u0437\u0430\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435"},{default:e(()=>[g]),_:1})])])]),m,s("ol",q,[s("li",null,[h,s("a",y,[j,t(p)])])]),x,_,f])}var C=i(r,[["render",w],["__file","jest-settings.html.vue"]]);export{C as default};
