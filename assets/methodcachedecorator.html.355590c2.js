import{_ as t,r as p,o,c as e,a as n,b as c,w as i,d as s,e as l}from"./app.40083dda.js";const u={},r=n("h1",{id:"\u0434\u0435\u043A\u043E\u0440\u0430\u0442\u043E\u0440-\u0434\u043B\u044F-\u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F-\u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0430-\u0432\u044B\u0437\u043E\u0432\u0430-\u043C\u0435\u0442\u043E\u0434\u0430",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u0434\u0435\u043A\u043E\u0440\u0430\u0442\u043E\u0440-\u0434\u043B\u044F-\u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F-\u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0430-\u0432\u044B\u0437\u043E\u0432\u0430-\u043C\u0435\u0442\u043E\u0434\u0430","aria-hidden":"true"},"#"),s(" \u0414\u0435\u043A\u043E\u0440\u0430\u0442\u043E\u0440 \u0434\u043B\u044F \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0430 \u0432\u044B\u0437\u043E\u0432\u0430 \u043C\u0435\u0442\u043E\u0434\u0430")],-1),k=s("\u0412 \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043A\u0435\u0448\u0430 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F "),d=s("\u041F\u0440\u043E\u0441\u0442\u043E\u0439 memory - \u043A\u0435\u0448"),v=l(`<p>\u041B\u043E\u0433\u0438\u043A\u0430 \u0440\u0430\u0431\u043E\u0442\u044B \u0434\u0435\u043A\u043E\u0440\u0430\u0442\u043E\u0440\u0430:</p><blockquote><ol><li>\u0435\u0441\u043B\u0438 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u043C\u0435\u0442\u043E\u0434\u0430 (\u0441 \u0437\u0430\u0434\u0430\u043D\u043D\u044B\u043C \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442\u0430\u043C\u0438) \u043F\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u043A\u0435\u0448\u0435 \u0438 \u0432\u0440\u0435\u043C\u044F \u0436\u0438\u0437\u043D\u0438 (\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430 \u043A\u0435\u0448\u0430) \u043D\u0435 \u0438\u0441\u0442\u0435\u043A\u043B\u043E,<br> \u0442\u043E \u043C\u0435\u0442\u043E\u0434 \u0432\u044B\u043F\u043E\u043B\u043D\u044F\u0442\u044C\u0441\u044F \u043D\u0435 \u0431\u0443\u0434\u0435\u0442, \u0431\u0443\u0434\u0435\u0442 \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442 \u0438\u0437 \u043A\u0435\u0448\u0430</li><li>\u0435\u0441\u043B\u0438 \u0432 \u043A\u0435\u0448\u0435 \u043D\u0435\u0442 \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u0430, \u0442\u043E \u0431\u0443\u0434\u0435\u0442 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D \u043C\u0435\u0442\u043E\u0434, \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442 \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043F\u0438\u0441\u0430\u043D \u0432 \u043A\u0435\u0448 \u0438 \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u043E \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435</li><li>\u043A\u043B\u044E\u0447\u0435\u043C \u0432 \u043A\u0435\u0448\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0441\u0442\u0440\u043E\u043A\u0430 <code>\u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u043C\u0435\u0442\u043E\u0434\u0430-\u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442\u044B</code> (\u043F\u0440\u0438 \u044D\u0442\u043E\u043C \u0433\u043B\u0443\u0431\u043E\u043A\u043E\u0433\u043E \u043A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043D\u0435 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u0434\u0438\u0442\u0441\u044F)</li></ol><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>propertyKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token operator">!</span><span class="token operator">!</span>args <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></blockquote><div class="custom-container tip"><p class="custom-container-title">\u0412\u0430\u0436\u043D\u043E !!!</p><p>\u0412 \u043A\u0435\u0448\u0435 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0435\u0442\u0441\u044F <code>Map</code>, \u0432 \u043A\u043E\u0442\u043E\u0440\u043E\u043C \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 &quot;\u0441\u043A\u0430\u043B\u0430\u0434\u044B\u0432\u0430\u0435\u0442\u0441\u044F&quot; \u043A\u0430\u043A \u0435\u0441\u0442\u044C - \u0431\u0435\u0437 \u043A\u0430\u043A\u043E\u0433\u043E-\u043B\u0438\u0431\u043E \u043A\u043B\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F, \u0442\u043E \u0435\u0441\u0442\u044C, \u0435\u0441\u043B\u0438 \u044D\u0442\u043E &quot;\u043E\u0431\u044C\u0435\u043A\u0442&quot; \u0442\u043E \u0431\u0443\u0434\u0435\u0442 \u0441\u043E\u0437\u0434\u0430\u043D\u0430 \u0441\u0441\u044B\u043B\u043A\u0430 (\u043A\u043B\u044E\u0447-\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435), \u043F\u0440\u0438 \u044D\u0442\u043E\u043C \u0435\u0441\u043B\u0438 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C (\u0438\u0437\u0432\u043D\u0435) \u043E\u0431\u044A\u0435\u043A\u0442, \u0442\u043E \u0441\u043E\u043E\u0442\u0432\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E, \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438 \u0438\u0437 \u043A\u0435\u0448\u0430 \u043E\u0431\u044A\u0435\u043A\u0442\u0430 \u043F\u043E \u043A\u043B\u044E\u0447\u0443 \u043C\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u043C &quot;\u0438\u0437\u043C\u0435\u043D\u0435\u043D\u043D\u044B\u0439&quot; \u043E\u0431\u044A\u0435\u043A\u0442, \u0430 \u043D\u0435 \u0442\u043E\u0442, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043C\u044B &quot;\u043F\u043E\u043B\u043E\u0436\u0438\u043B\u0438&quot;</p></div><p>\u0423\u0447\u0438\u0442\u044B\u0432\u0430\u044F, \u0447\u0442\u043E \u0432 \u043D\u0430\u0448\u0435\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043A\u0442\u0443\u0440\u0435 \u0432\u0441\u0451 \u0432\u0437\u0430\u0438\u043C\u043E\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0441 API \u043E\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043B\u044F\u0435\u0442\u0441\u044F <strong>\u0441\u0442\u0440\u043E\u0433\u043E</strong> \u0447\u0435\u0440\u0435\u0437 \u0441\u0435\u0440\u0432\u0438\u0441\u044B,<br> \u0443\u0434\u043E\u0431\u043D\u043E \u0443\u043F\u0430\u0440\u0430\u0432\u043B\u044F\u0442\u044C \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435\u043C \u0432\u044B\u0437\u043E\u0432\u043E\u0432.</p><p><strong>\u041A\u043E\u0434 \u0434\u0435\u043A\u043E\u0440\u0430\u0442\u043E\u0440\u0430 @Cacheable(\u0432\u0440\u0435\u043C\u044F \u0436\u0438\u0437\u043D\u0438)</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> MemoryCache <span class="token keyword">from</span> <span class="token string">&quot;./MemoryCache&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Cacheable</span> <span class="token operator">=</span>
  <span class="token punctuation">(</span>maxAge <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token punctuation">(</span>_target<span class="token operator">:</span> Object<span class="token punctuation">,</span> propertyKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> descriptor<span class="token operator">:</span> PropertyDescriptor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> originalMethod <span class="token operator">=</span> descriptor<span class="token punctuation">.</span>value<span class="token punctuation">;</span>

    descriptor<span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>propertyKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token operator">!</span><span class="token operator">!</span>args <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> val <span class="token operator">=</span> MemoryCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> originVal <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        MemoryCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> originVal<span class="token punctuation">,</span> maxAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> originVal<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> val<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> descriptor<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Cacheable<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u041F\u0440\u0438\u043C\u0435\u0440</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatalogService</span> <span class="token keyword">extends</span> <span class="token class-name">BaseService</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u0415\u0441\u043B\u0438 \u0432\u0440\u0435\u043C\u044F \u0436\u0438\u0437\u043D\u0438 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0432 0 - \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442 \u0432\u044B\u0437\u043E\u0432\u0430 \u0431\u0443\u0434\u0435\u0442 &quot;\u0436\u0438\u0442\u044C&quot; \u0432 \u043A\u0435\u0448\u0435 \u0432\u0435\u0447\u043D\u043E  </span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Cacheable</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getSearchProducts</span> <span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> search<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getArrayOrEmpty</span><span class="token punctuation">(</span>ProductModel<span class="token punctuation">,</span> <span class="token string">&quot;users/products&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> search <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Cacheable</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getCatalog</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOneOrDefault</span><span class="token punctuation">(</span>CatalogModel<span class="token punctuation">,</span> <span class="token string">&quot;users/pages/catalog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Cacheable</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token function">getProductBySlug</span> <span class="token punctuation">(</span>slug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getIdBySlug</span><span class="token punctuation">(</span>slug<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOneOrDefault</span><span class="token punctuation">(</span>ProductModel<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">users/products/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Cacheable</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getRoot</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getArrayOrEmpty</span><span class="token punctuation">(</span>CategoryModel<span class="token punctuation">,</span> <span class="token string">&quot;users/product-categories-menu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Cacheable</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getCategoryBySlug</span> <span class="token punctuation">(</span>slug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getIdBySlug</span><span class="token punctuation">(</span>slug<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getOneOrDefault</span><span class="token punctuation">(</span>CategoryModel<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">users/product-categories/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">toogleFavorites</span> <span class="token punctuation">(</span>product<span class="token operator">:</span> ProductModel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>apiRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">users/products/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>product<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/favorites</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> product_id<span class="token operator">:</span> product<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line">\xA0</div><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><div class="highlight-line">\xA0</div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8);function m(b,g){const a=p("RouterLink");return o(),e("div",null,[r,n("p",null,[k,c(a,{to:"/nuxt2/other/memorycache.html"},{default:i(()=>[d]),_:1})]),v])}var h=t(u,[["render",m],["__file","methodcachedecorator.html.vue"]]);export{h as default};
